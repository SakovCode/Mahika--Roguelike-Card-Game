{
  "associatedLayout": "Forest",
  "lastChangeTimeStamp": 0,
  "name": "LvlEvents",
  "events": [
    {
      "colorB": 228,
      "colorG": 176,
      "colorR": 74,
      "creationTime": 0,
      "name": "DEBUG",
      "source": "",
      "type": "BuiltinCommonInstructions::Group",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [],
          "actions": []
        }
      ],
      "parameters": []
    },
    {
      "colorB": 228,
      "colorG": 176,
      "colorR": 74,
      "creationTime": 0,
      "folded": true,
      "name": "LOAD",
      "source": "",
      "type": "BuiltinCommonInstructions::Group",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "DepartScene"
              },
              "parameters": [
                ""
              ]
            }
          ],
          "actions": [],
          "events": [
            {
              "type": "BuiltinCommonInstructions::Standard",
              "conditions": [
                {
                  "type": {
                    "value": "NumberVariable"
                  },
                  "parameters": [
                    "load",
                    "=",
                    "1"
                  ]
                }
              ],
              "actions": []
            }
          ]
        }
      ],
      "parameters": []
    },
    {
      "colorB": 228,
      "colorG": 176,
      "colorR": 74,
      "creationTime": 0,
      "name": "SAVE",
      "source": "",
      "type": "BuiltinCommonInstructions::Group",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "ButtonStates::ButtonFSM::IsClicked"
              },
              "parameters": [
                "SaveButton2",
                "ButtonFSM",
                ""
              ]
            }
          ],
          "actions": [
            {
              "type": {
                "value": "ClearVariableChildren"
              },
              "parameters": [
                "SaveTerrain"
              ]
            },
            {
              "type": {
                "value": "ClearVariableChildren"
              },
              "parameters": [
                "SaveEnemy"
              ]
            },
            {
              "type": {
                "value": "ClearVariableChildren"
              },
              "parameters": [
                "SavePlayer"
              ]
            }
          ],
          "events": [
            {
              "colorB": 228,
              "colorG": 176,
              "colorR": 74,
              "creationTime": 0,
              "folded": true,
              "name": "LEVEL",
              "source": "",
              "type": "BuiltinCommonInstructions::Group",
              "events": [
                {
                  "type": "BuiltinCommonInstructions::Standard",
                  "conditions": [
                    {
                      "type": {
                        "value": "BuiltinCommonInstructions::Once"
                      },
                      "parameters": []
                    }
                  ],
                  "actions": [
                    {
                      "type": {
                        "value": "PushString"
                      },
                      "parameters": [
                        "Variable",
                        "CurrentSceneName()"
                      ]
                    },
                    {
                      "type": {
                        "value": "EcrireFichierTxt"
                      },
                      "parameters": [
                        "\"Storage\"",
                        "\"Level\"",
                        "ToJSON(Variable)"
                      ]
                    }
                  ],
                  "variables": [
                    {
                      "name": "Variable",
                      "type": "array",
                      "children": []
                    }
                  ]
                }
              ],
              "parameters": []
            },
            {
              "colorB": 228,
              "colorG": 176,
              "colorR": 74,
              "creationTime": 0,
              "folded": true,
              "name": "SAVE TERRAIN",
              "source": "",
              "type": "BuiltinCommonInstructions::Group",
              "events": [
                {
                  "type": "BuiltinCommonInstructions::ForEach",
                  "object": "Terrain",
                  "conditions": [],
                  "actions": [
                    {
                      "type": {
                        "value": "PushString"
                      },
                      "parameters": [
                        "SaveTerrain",
                        "Terrain.ObjectName()"
                      ]
                    },
                    {
                      "type": {
                        "value": "PushNumber"
                      },
                      "parameters": [
                        "SaveTerrain",
                        "Terrain.X()"
                      ]
                    },
                    {
                      "type": {
                        "value": "PushNumber"
                      },
                      "parameters": [
                        "SaveTerrain",
                        "Terrain.Y()"
                      ]
                    }
                  ]
                },
                {
                  "type": "BuiltinCommonInstructions::Standard",
                  "conditions": [
                    {
                      "type": {
                        "value": "BuiltinCommonInstructions::Once"
                      },
                      "parameters": []
                    }
                  ],
                  "actions": [
                    {
                      "type": {
                        "value": "EcrireFichierTxt"
                      },
                      "parameters": [
                        "\"Storage\"",
                        "\"Terrain\"",
                        "ToJSON(SaveTerrain)"
                      ]
                    }
                  ]
                }
              ],
              "parameters": []
            },
            {
              "colorB": 228,
              "colorG": 176,
              "colorR": 74,
              "creationTime": 0,
              "folded": true,
              "name": "SAVE ENEMIES",
              "source": "",
              "type": "BuiltinCommonInstructions::Group",
              "events": [
                {
                  "type": "BuiltinCommonInstructions::ForEach",
                  "object": "Enemy",
                  "conditions": [],
                  "actions": [
                    {
                      "type": {
                        "value": "PushString"
                      },
                      "parameters": [
                        "SaveEnemy",
                        "Enemy.ObjectName()"
                      ]
                    },
                    {
                      "type": {
                        "value": "PushNumber"
                      },
                      "parameters": [
                        "SaveEnemy",
                        "Enemy.X()"
                      ]
                    },
                    {
                      "type": {
                        "value": "PushNumber"
                      },
                      "parameters": [
                        "SaveEnemy",
                        "Enemy.Y()"
                      ]
                    }
                  ]
                },
                {
                  "type": "BuiltinCommonInstructions::Standard",
                  "conditions": [
                    {
                      "type": {
                        "value": "BuiltinCommonInstructions::Once"
                      },
                      "parameters": []
                    }
                  ],
                  "actions": [
                    {
                      "type": {
                        "value": "EcrireFichierTxt"
                      },
                      "parameters": [
                        "\"Storage\"",
                        "\"Enemy\"",
                        "ToJSON(SaveEnemy)"
                      ]
                    }
                  ]
                }
              ],
              "parameters": []
            },
            {
              "colorB": 228,
              "colorG": 176,
              "colorR": 74,
              "creationTime": 0,
              "folded": true,
              "name": "SAVE PLAYER",
              "source": "",
              "type": "BuiltinCommonInstructions::Group",
              "events": [
                {
                  "type": "BuiltinCommonInstructions::ForEach",
                  "object": "Player",
                  "conditions": [],
                  "actions": [
                    {
                      "type": {
                        "value": "PushString"
                      },
                      "parameters": [
                        "SavePlayer",
                        "Player.ObjectName()"
                      ]
                    },
                    {
                      "type": {
                        "value": "PushNumber"
                      },
                      "parameters": [
                        "SavePlayer",
                        "Player.X()"
                      ]
                    },
                    {
                      "type": {
                        "value": "PushNumber"
                      },
                      "parameters": [
                        "SavePlayer",
                        "Player.Y()"
                      ]
                    },
                    {
                      "type": {
                        "value": "PushNumber"
                      },
                      "parameters": [
                        "SavePlayer",
                        "PlayerHP"
                      ]
                    },
                    {
                      "type": {
                        "value": "PushNumber"
                      },
                      "parameters": [
                        "SavePlayer",
                        "PlayerMaxMana"
                      ]
                    }
                  ]
                },
                {
                  "type": "BuiltinCommonInstructions::Standard",
                  "conditions": [
                    {
                      "type": {
                        "value": "BuiltinCommonInstructions::Once"
                      },
                      "parameters": []
                    }
                  ],
                  "actions": [
                    {
                      "type": {
                        "value": "EcrireFichierTxt"
                      },
                      "parameters": [
                        "\"Storage\"",
                        "\"Player\"",
                        "ToJSON(SavePlayer)"
                      ]
                    }
                  ]
                }
              ],
              "parameters": []
            },
            {
              "type": "BuiltinCommonInstructions::Standard",
              "conditions": [
                {
                  "type": {
                    "value": "BuiltinCommonInstructions::Once"
                  },
                  "parameters": []
                }
              ],
              "actions": [
                {
                  "type": {
                    "value": "SetBooleanVariable"
                  },
                  "parameters": [
                    "Variable",
                    "True",
                    ""
                  ]
                },
                {
                  "type": {
                    "value": "EcrireFichierExp"
                  },
                  "parameters": [
                    "\"Storage\"",
                    "\"SaveExists\"",
                    "Variable"
                  ]
                }
              ],
              "variables": [
                {
                  "name": "Variable",
                  "type": "boolean",
                  "value": false
                }
              ]
            }
          ]
        }
      ],
      "parameters": []
    },
    {
      "colorB": 228,
      "colorG": 176,
      "colorR": 74,
      "creationTime": 0,
      "folded": true,
      "name": "EnemyLOS",
      "source": "",
      "type": "BuiltinCommonInstructions::Group",
      "events": [
        {
          "type": "BuiltinCommonInstructions::ForEach",
          "object": "Enemy",
          "conditions": [
            {
              "type": {
                "value": "Raycast"
              },
              "parameters": [
                "PlayerAndSolid",
                "Enemy.X()",
                "Enemy.Y()",
                "ToDeg(atan2(Player.Y() - Enemy.Y(), Player.X() - Enemy.X()))",
                "200",
                "Intersection.X",
                "Intersection.Y",
                ""
              ]
            }
          ],
          "actions": [],
          "events": [
            {
              "type": "BuiltinCommonInstructions::Standard",
              "conditions": [
                {
                  "type": {
                    "value": "PickedInstancesCount"
                  },
                  "parameters": [
                    "Player",
                    ">",
                    "0"
                  ]
                }
              ],
              "actions": [
                {
                  "type": {
                    "value": "SetBooleanObjectVariable"
                  },
                  "parameters": [
                    "Enemy",
                    "isAlerted",
                    "True",
                    ""
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "inverted": true,
                "value": "Distance"
              },
              "parameters": [
                "Enemy",
                "Player",
                "300",
                ""
              ]
            }
          ],
          "actions": [
            {
              "type": {
                "value": "SetBooleanObjectVariable"
              },
              "parameters": [
                "Enemy",
                "isAlerted",
                "False",
                ""
              ]
            }
          ]
        }
      ],
      "parameters": []
    },
    {
      "colorB": 228,
      "colorG": 176,
      "colorR": 74,
      "creationTime": 0,
      "folded": true,
      "name": "EnemyMovement/Animation",
      "source": "",
      "type": "BuiltinCommonInstructions::Group",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "BooleanObjectVariable"
              },
              "parameters": [
                "Enemy",
                "isAlerted",
                "True",
                ""
              ]
            }
          ],
          "actions": [],
          "events": [
            {
              "type": "BuiltinCommonInstructions::Standard",
              "conditions": [],
              "actions": [
                {
                  "type": {
                    "value": "AnimatableCapability::AnimatableBehavior::SetName"
                  },
                  "parameters": [
                    "Enemy",
                    "Animation",
                    "=",
                    "\"walk\""
                  ]
                },
                {
                  "type": {
                    "value": "PathfindingBehavior::SetDestination"
                  },
                  "parameters": [
                    "Enemy",
                    "Pathfinding",
                    "",
                    "Player.X()",
                    "Player.Y()"
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "PathfindingBehavior::Speed"
              },
              "parameters": [
                "Enemy",
                "Pathfinding",
                "<=",
                "0"
              ]
            }
          ],
          "actions": [
            {
              "type": {
                "value": "AnimatableCapability::AnimatableBehavior::SetName"
              },
              "parameters": [
                "Enemy",
                "Animation",
                "=",
                "\"idle\""
              ]
            }
          ]
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [],
          "actions": [
            {
              "type": {
                "value": "SeparateFromObjects"
              },
              "parameters": [
                "Enemy",
                "Portal",
                ""
              ]
            }
          ]
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [],
          "actions": [
            {
              "type": {
                "value": "SeparateFromObjects"
              },
              "parameters": [
                "Enemy",
                "ForestWall",
                ""
              ]
            }
          ]
        }
      ],
      "parameters": []
    },
    {
      "colorB": 228,
      "colorG": 176,
      "colorR": 74,
      "creationTime": 0,
      "folded": true,
      "name": "EnemyEncounter",
      "source": "",
      "type": "BuiltinCommonInstructions::Group",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "CollisionNP"
              },
              "parameters": [
                "Enemy",
                "Player",
                "",
                "",
                "yes"
              ]
            }
          ],
          "actions": [
            {
              "type": {
                "value": "SetStringVariable"
              },
              "parameters": [
                "encounterID",
                "=",
                "Enemy.ObjectName()"
              ]
            },
            {
              "type": {
                "value": "Delete"
              },
              "parameters": [
                "Enemy",
                ""
              ]
            },
            {
              "type": {
                "value": "PushScene"
              },
              "parameters": [
                "",
                "\"Battle\""
              ]
            }
          ]
        }
      ],
      "parameters": []
    },
    {
      "colorB": 228,
      "colorG": 176,
      "colorR": 74,
      "creationTime": 0,
      "folded": true,
      "name": "LVL CLEAR CONDITION",
      "source": "",
      "type": "BuiltinCommonInstructions::Group",
      "events": [
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "NumberVariable"
              },
              "parameters": [
                "enemyDefeated",
                ">=",
                "3"
              ]
            }
          ],
          "actions": [],
          "events": [
            {
              "type": "BuiltinCommonInstructions::Standard",
              "conditions": [
                {
                  "type": {
                    "value": "CollisionNP"
                  },
                  "parameters": [
                    "Player",
                    "Portal",
                    "",
                    "",
                    "yes"
                  ]
                }
              ],
              "actions": [
                {
                  "type": {
                    "value": "Scene"
                  },
                  "parameters": [
                    "",
                    "CurrentSceneName()+\"Boss\"",
                    "yes"
                  ]
                },
                {
                  "type": {
                    "value": "SetNumberVariable"
                  },
                  "parameters": [
                    "load",
                    "=",
                    "0"
                  ]
                }
              ]
            }
          ]
        }
      ],
      "parameters": []
    },
    {
      "colorB": 228,
      "colorG": 176,
      "colorR": 74,
      "creationTime": 0,
      "folded": true,
      "name": "ENEMY VISIBILITY",
      "source": "",
      "type": "BuiltinCommonInstructions::Group",
      "events": [
        {
          "type": "BuiltinCommonInstructions::ForEach",
          "object": "Enemy",
          "conditions": [
            {
              "type": {
                "value": "Raycast"
              },
              "parameters": [
                "EnemyAndSolid",
                "Player.X()",
                "Player.Y()",
                "ToDeg(atan2(Enemy.Y() - Player.Y(), Enemy.X() - Player.X()))",
                "300",
                "Intersection.X",
                "Intersection.Y",
                ""
              ]
            }
          ],
          "actions": [],
          "events": [
            {
              "type": "BuiltinCommonInstructions::Standard",
              "conditions": [
                {
                  "type": {
                    "value": "PickedInstancesCount"
                  },
                  "parameters": [
                    "Enemy",
                    ">",
                    "0"
                  ]
                }
              ],
              "actions": [
                {
                  "type": {
                    "value": "SetBooleanObjectVariable"
                  },
                  "parameters": [
                    "Enemy",
                    "isSpotted",
                    "True",
                    ""
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "BooleanObjectVariable"
              },
              "parameters": [
                "Enemy",
                "isSpotted",
                "True",
                ""
              ]
            }
          ],
          "actions": [
            {
              "type": {
                "value": "Montre"
              },
              "parameters": [
                "Enemy",
                ""
              ]
            },
            {
              "type": {
                "value": "Wait"
              },
              "parameters": [
                ".01"
              ]
            },
            {
              "type": {
                "value": "SetBooleanObjectVariable"
              },
              "parameters": [
                "Enemy",
                "isSpotted",
                "False",
                ""
              ]
            }
          ]
        },
        {
          "type": "BuiltinCommonInstructions::Standard",
          "conditions": [
            {
              "type": {
                "value": "BooleanObjectVariable"
              },
              "parameters": [
                "Enemy",
                "isSpotted",
                "False",
                ""
              ]
            }
          ],
          "actions": [
            {
              "type": {
                "value": "Cache"
              },
              "parameters": [
                "Enemy"
              ]
            }
          ]
        }
      ],
      "parameters": []
    }
  ]
}